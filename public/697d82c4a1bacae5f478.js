import"./index.css";import*as THREE from"../node_modules/three/build/three.module.js";import{OrbitControls}from"../node_modules/three/examples/jsm/controls/OrbitControls.js";import{GLTFLoader}from"../node_modules/three/examples/jsm/loaders/GLTFLoader.js";import{DRACOLoader}from"../node_modules/three/examples/jsm/loaders/DRACOLoader.js";import firefliesVertexShader from"./shaders/fireflies/vertex.js";import firefliesFragmentShader from"./shaders/fireflies/fragment.js";import alcoolVertexShader from"./shaders/alcool/vertex.js";import alcoolFragmentShader from"./shaders/alcool/fragment.js";const canvas=document.getElementsByClassName("webgl")[0];if(canvas){const e=new THREE.Scene,a=new THREE.TextureLoader,t=new DRACOLoader;t.setDecoderPath("draco/");const o=new GLTFLoader;o.setDRACOLoader(t);const i=a.load("texture_cocktail.jpg");i.flipY=!1;const r=new THREE.MeshBasicMaterial({map:i});i.encoding=THREE.sRGBEncoding;const n=new THREE.PlaneGeometry(50,50,52,212),l=new THREE.ShaderMaterial({vertexShader:alcoolVertexShader(),fragmentShader:alcoolFragmentShader(),uniforms:{uTime:{value:0},uBigWavesElevation:{value:.277},uBigWavesFrequency:{value:new THREE.Vector2(0,.183)},uBigWavesSpeed:{value:.826},uSmallWavesElevation:{value:.135},uSmallWavesFrequency:{value:2.96},uSmallWavesSpeed:{value:.83},uSmallIterations:{value:3},uDepthColor:{value:new THREE.Color("#009bdc")},uSurfaceColor:{value:new THREE.Color("#5cb9f7")},uColorOffset:{value:.08},uColorMultiplier:{value:5}}}),s=new THREE.Mesh(n,l);s.rotation.x=.5*-Math.PI,s.position.y=-.5,e.add(s),o.load("cocktail_scene_allin.glb",(a=>{e.add(a.scene),a.scene.children.find((e=>"Plane005"===e.name)).material=r}));const d=new THREE.BufferGeometry,m=30,u=new Float32Array(3*m),c=new Float32Array(m);for(let e=0;e<m;e++)u[3*e+0]=4*(Math.random()-.5),u[3*e+1]=4*Math.random(),u[3*e+2]=4*(Math.random()-.5),c[e]=Math.random();d.setAttribute("position",new THREE.BufferAttribute(u,3)),d.setAttribute("aScale",new THREE.BufferAttribute(c,1));const h=new THREE.ShaderMaterial({uniforms:{uPixelRatio:{value:Math.min(window.devicePixelRatio,2)},uSize:{value:100},uTime:{value:0}},vertexShader:firefliesVertexShader(),fragmentShader:firefliesFragmentShader(),transparent:!0,blending:THREE.AdditiveBlending,depthWrite:!1}),E=new THREE.Points(d,h);e.add(E);const w={width:window.innerWidth-100,height:window.innerHeight/2};window.addEventListener("resize",(()=>{w.width=window.innerWidth-100,w.height=window.innerHeight/2,f.aspect=w.width/w.height,f.updateProjectionMatrix(),R.setSize(w.width,w.height),R.setPixelRatio(Math.min(window.devicePixelRatio,2)),h.uniforms.uPixelRatio.value=Math.min(window.devicePixelRatio,2)}));const f=new THREE.PerspectiveCamera(25,w.width/w.height,.1,30);f.position.x=0,f.position.y=5,f.position.z=18,e.add(f);const v=new OrbitControls(f,canvas);v.enableDamping=!0;const R=new THREE.WebGLRenderer({canvas,antialias:!0});R.setSize(w.width,w.height),R.setPixelRatio(Math.min(window.devicePixelRatio,2)),R.outputEncoding=THREE.sRGBEncoding,R.setClearColor("#74c8f7");const p=new THREE.Clock,g=()=>{const a=p.getElapsedTime();h.uniforms.uTime.value=a,l.uniforms.uTime.value=a,v.update(),R.render(e,f),window.requestAnimationFrame(g)};g()}console.log("hey");